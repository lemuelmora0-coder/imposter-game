<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ST VINCENT: Impostor</title>
    <style>
        :root { --glow: #00d4ff; --bg: #0a0e14; --card: #151d29; --text: #e0e6ed; --danger: #ff4757; }
        
        /* --- GALAXY BACKGROUND ANIMATION CSS --- */
        html, body { height: 100%; margin: 0; overflow: hidden; }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%); 
            color: var(--text); 
            text-align: center; 
            user-select: none;
            display: flex; justify-content: center; align-items: center;
        }
        /* Function to generate random stars (simulated for plain CSS) */
        .stars-1 { width: 1px; height: 1px; background: transparent; box-shadow: 137px 345px #FFF , 1696px 1665px #FFF , 639px 510px #FFF , 27px 88px #FFF , 881px 1770px #FFF , 900px 267px #FFF , 1762px 1759px #FFF , 1667px 675px #FFF , 798px 356px #FFF , 752px 1569px #FFF , 1347px 768px #FFF , 1200px 1444px #FFF , 1013px 136px #FFF , 1992px 1396px #FFF , 337px 510px #FFF , 116px 1306px #FFF , 269px 1730px #FFF , 1237px 1236px #FFF , 98px 181px #FFF , 438px 1576px #FFF , 1794px 68px #FFF , 1170px 1633px #FFF , 1862px 1306px #FFF , 1902px 174px #FFF , 285px 657px #FFF , 413px 1411px #FFF , 1524px 511px #FFF , 1841px 223px #FFF , 1266px 1065px #FFF , 1407px 1451px #FFF , 1525px 99px #FFF , 1863px 112px #FFF , 1668px 770px #FFF , 330px 96px #FFF , 1941px 749px #FFF , 1373px 931px #FFF , 892px 1780px #FFF , 796px 1427px #FFF , 1477px 1145px #FFF , 590px 556px #FFF , 88px 1053px #FFF , 27px 1773px #FFF , 1182px 1040px #FFF , 827px 784px #FFF , 1629px 537px #FFF , 766px 1173px #FFF , 775px 1456px #FFF , 31px 1764px #FFF , 326px 1396px #FFF , 673px 667px #FFF; animation: animStar 50s linear infinite; }
        .stars-1:after { content: " "; position: absolute; top: 2000px; width: 1px; height: 1px; background: transparent; box-shadow: 137px 345px #FFF , 1696px 1665px #FFF , 639px 510px #FFF , 27px 88px #FFF , 881px 1770px #FFF , 900px 267px #FFF , 1762px 1759px #FFF , 1667px 675px #FFF , 798px 356px #FFF , 752px 1569px #FFF , 1347px 768px #FFF , 1200px 1444px #FFF , 1013px 136px #FFF , 1992px 1396px #FFF , 337px 510px #FFF , 116px 1306px #FFF , 269px 1730px #FFF , 1237px 1236px #FFF , 98px 181px #FFF , 438px 1576px #FFF , 1794px 68px #FFF , 1170px 1633px #FFF , 1862px 1306px #FFF , 1902px 174px #FFF , 285px 657px #FFF , 413px 1411px #FFF , 1524px 511px #FFF , 1841px 223px #FFF , 1266px 1065px #FFF , 1407px 1451px #FFF , 1525px 99px #FFF , 1863px 112px #FFF , 1668px 770px #FFF , 330px 96px #FFF , 1941px 749px #FFF , 1373px 931px #FFF , 892px 1780px #FFF , 796px 1427px #FFF , 1477px 1145px #FFF , 590px 556px #FFF , 88px 1053px #FFF , 27px 1773px #FFF , 1182px 1040px #FFF , 827px 784px #FFF , 1629px 537px #FFF , 766px 1173px #FFF , 775px 1456px #FFF , 31px 1764px #FFF , 326px 1396px #FFF , 673px 667px #FFF; }
        .stars-2 { width: 2px; height: 2px; background: transparent; box-shadow: 1305px 37px #FFF , 1409px 350px #FFF , 1893px 1385px #FFF , 656px 561px #FFF , 1344px 486px #FFF , 655px 1133px #FFF , 1082px 1261px #FFF , 1882px 785px #FFF , 1914px 275px #FFF , 1760px 1028px #FFF , 74px 1411px #FFF , 1869px 1578px #FFF , 1620px 67px #FFF , 315px 1350px #FFF , 1520px 1353px #FFF , 433px 1700px #FFF , 98px 1813px #FFF , 878px 806px #FFF , 1601px 1789px #FFF , 1223px 34px #FFF , 1421px 1481px #FFF , 1512px 949px #FFF , 684px 895px #FFF , 1461px 1335px #FFF , 1422px 37px #FFF , 829px 1449px #FFF , 764px 844px #FFF , 211px 1207px #FFF , 180px 1627px #FFF , 1233px 738px #FFF , 1690px 1735px #FFF , 150px 1131px #FFF , 316px 107px #FFF , 1568px 375px #FFF , 97px 977px #FFF , 1811px 172px #FFF , 1001px 858px #FFF , 655px 1054px #FFF , 1481px 1379px #FFF , 1168px 1405px #FFF , 253px 1588px #FFF , 710px 1497px #FFF , 833px 524px #FFF , 311px 1508px #FFF , 1587px 280px #FFF , 1123px 1002px #FFF , 1923px 1488px #FFF , 1456px 392px #FFF , 347px 570px #FFF , 79px 546px #FFF; animation: animStar 100s linear infinite; }
        .stars-2:after { content: " "; position: absolute; top: 2000px; width: 2px; height: 2px; background: transparent; box-shadow: 1305px 37px #FFF , 1409px 350px #FFF , 1893px 1385px #FFF , 656px 561px #FFF , 1344px 486px #FFF , 655px 1133px #FFF , 1082px 1261px #FFF , 1882px 785px #FFF , 1914px 275px #FFF , 1760px 1028px #FFF , 74px 1411px #FFF , 1869px 1578px #FFF , 1620px 67px #FFF , 315px 1350px #FFF , 1520px 1353px #FFF , 433px 1700px #FFF , 98px 1813px #FFF , 878px 806px #FFF , 1601px 1789px #FFF , 1223px 34px #FFF , 1421px 1481px #FFF , 1512px 949px #FFF , 684px 895px #FFF , 1461px 1335px #FFF , 1422px 37px #FFF , 829px 1449px #FFF , 764px 844px #FFF , 211px 1207px #FFF , 180px 1627px #FFF , 1233px 738px #FFF , 1690px 1735px #FFF , 150px 1131px #FFF , 316px 107px #FFF , 1568px 375px #FFF , 97px 977px #FFF , 1811px 172px #FFF , 1001px 858px #FFF , 655px 1054px #FFF , 1481px 1379px #FFF , 1168px 1405px #FFF , 253px 1588px #FFF , 710px 1497px #FFF , 833px 524px #FFF , 311px 1508px #FFF , 1587px 280px #FFF , 1123px 1002px #FFF , 1923px 1488px #FFF , 1456px 392px #FFF , 347px 570px #FFF , 79px 546px #FFF; }
        .stars-3 { width: 3px; height: 3px; background: transparent; box-shadow: 800px 907px #FFF , 1784px 73px #FFF , 1845px 121px #FFF , 209px 148px #FFF , 382px 1088px #FFF , 1064px 1697px #FFF , 1415px 1247px #FFF , 870px 1468px #FFF , 864px 1739px #FFF , 326px 1662px #FFF , 1093px 544px #FFF , 1429px 377px #FFF , 1883px 938px #FFF , 1199px 1284px #FFF , 1135px 498px #FFF , 1377px 1728px #FFF , 1587px 772px #FFF , 482px 398px #FFF , 1952px 512px #FFF , 934px 847px #FFF , 1743px 1423px #FFF , 145px 268px #FFF , 1668px 112px #FFF , 1924px 802px #FFF , 776px 1385px #FFF , 1879px 1137px #FFF , 504px 239px #FFF , 947px 508px #FFF , 1305px 154px #FFF , 1361px 1372px #FFF , 1293px 1432px #FFF , 1050px 1406px #FFF , 1346px 96px #FFF , 978px 426px #FFF , 212px 615px #FFF , 1852px 66px #FFF , 1988px 369px #FFF , 558px 643px #FFF , 223px 317px #FFF , 1231px 1100px #FFF , 1399px 1560px #FFF , 1457px 320px #FFF , 1102px 1414px #FFF , 1440px 223px #FFF , 604px 1008px #FFF , 956px 113px #FFF , 174px 930px #FFF , 1998px 1753px #FFF , 1620px 1281px #FFF , 483px 1683px #FFF; animation: animStar 150s linear infinite; }
        .stars-3:after { content: " "; position: absolute; top: 2000px; width: 3px; height: 3px; background: transparent; box-shadow: 800px 907px #FFF , 1784px 73px #FFF , 1845px 121px #FFF , 209px 148px #FFF , 382px 1088px #FFF , 1064px 1697px #FFF , 1415px 1247px #FFF , 870px 1468px #FFF , 864px 1739px #FFF , 326px 1662px #FFF , 1093px 544px #FFF , 1429px 377px #FFF , 1883px 938px #FFF , 1199px 1284px #FFF , 1135px 498px #FFF , 1377px 1728px #FFF , 1587px 772px #FFF , 482px 398px #FFF , 1952px 512px #FFF , 934px 847px #FFF , 1743px 1423px #FFF , 145px 268px #FFF , 1668px 112px #FFF , 1924px 802px #FFF , 776px 1385px #FFF , 1879px 1137px #FFF , 504px 239px #FFF , 947px 508px #FFF , 1305px 154px #FFF , 1361px 1372px #FFF , 1293px 1432px #FFF , 1050px 1406px #FFF , 1346px 96px #FFF , 978px 426px #FFF , 212px 615px #FFF , 1852px 66px #FFF , 1988px 369px #FFF , 558px 643px #FFF , 223px 317px #FFF , 1231px 1100px #FFF , 1399px 1560px #FFF , 1457px 320px #FFF , 1102px 1414px #FFF , 1440px 223px #FFF , 604px 1008px #FFF , 956px 113px #FFF , 174px 930px #FFF , 1998px 1753px #FFF , 1620px 1281px #FFF , 483px 1683px #FFF; }
        @keyframes animStar { from { transform: translateY(0px); } to { transform: translateY(-2000px); } }
        
        /* --- MAIN CONTENT STYLES --- */
        .content-wrapper { z-index: 10; position: relative; width: 100%; padding: 20px; }
        .card { background: rgba(21, 29, 41, 0.85); backdrop-filter: blur(10px); padding: 30px; border-radius: 20px; border: 1px solid #30363d; display: inline-block; width: 90%; max-width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        h2 { color: var(--glow); text-transform: uppercase; letter-spacing: 2px; font-size: 1.5rem; text-shadow: 0 0 10px var(--glow); }
        input, select { background: rgba(13, 17, 23, 0.9); border: 1px solid #30363d; color: var(--glow); padding: 12px; border-radius: 8px; width: 85%; margin: 10px 0; font-size: 1rem; outline: none; }
        input:focus, select:focus { border-color: var(--glow); box-shadow: 0 0 15px rgba(0, 212, 255, 0.3); }
        button { background: var(--glow); color: #000; font-weight: bold; border: none; padding: 15px; border-radius: 10px; cursor: pointer; width: 100%; margin-top: 15px; text-transform: uppercase; transition: 0.3s; }
        button:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--glow); }
        .word-box { font-size: 2.2rem; font-weight: 900; margin: 30px 0; min-height: 60px; color: var(--danger); transition: 0.2s; text-shadow: 0 0 15px var(--danger); }
        .hold-btn { background: rgba(48, 54, 61, 0.7); color: white; padding: 25px; border: 2px dashed var(--glow); border-radius: 15px; cursor: pointer; touch-action: manipulation; font-weight: bold; letter-spacing: 1px; transition: 0.2s; }
        .hold-btn:active { background: var(--glow); color: black; box-shadow: 0 0 30px var(--glow); border-style: solid; }
        .hidden { display: none !important; }
        .deck-list { text-align: left; margin: 10px 0; font-size: 0.9rem; color: #8b949e; }
    </style>
</head>
<body>

    <div class="stars-1" style="position: fixed; width: 1px; height: 1px; top: 0; left: 0; z-index: 1;"></div>
    <div class="stars-2" style="position: fixed; width: 2px; height: 2px; top: 0; left: 0; z-index: 2;"></div>
    <div class="stars-3" style="position: fixed; width: 3px; height: 3px; top: 0; left: 0; z-index: 3;"></div>

    <div class="content-wrapper">
        <div id="setup-screen" class="card">
            <h2>ST VINCENT, WHO'S THE IMPOSTOR</h2>
            <div class="deck-list">LOAD PREVIOUS DECK:</div>
            <select id="saved-decks-dropdown" onchange="loadDeck()">
                <option value="">-- New Deck --</option>
            </select>
            <p style="margin: 10px 0 5px; color: #8b949e;">DECK NAME:</p>
            <input type="text" id="deck-name" placeholder="e.g. Robotics">
            <p style="margin: 10px 0 5px; color: #8b949e;">WORDS (Comma separated):</p>
            <input type="text" id="custom-words" placeholder="Word1, Word2, Word3">
            <button onclick="startGame()">INITIALIZE LINK</button>
        </div>

        <div id="game-screen" class="card hidden">
            <h3 id="player-turn-text">UNIT 1 READY</h3>
            <div id="word-display" class="word-box">****</div>
            <div id="hold-trigger" class="hold-btn">HOLD TO DECRYPT</div>
            <button id="next-btn" class="hidden" onclick="nextPlayer()">DONE & PASS</button>
        </div>

        <div id="reveal-screen" class="card hidden">
            <h2 style="color: var(--danger); text-shadow: 0 0 20px var(--danger);">/// ANOMALY DETECTED ///</h2>
            <p style="font-size: 1.2rem; margin-bottom: 5px;">THE IMPOSTOR WAS:</p>
            <div id="impostor-reveal" class="word-box" style="color: var(--glow); text-shadow: 0 0 20px var(--glow);">?</div>
            <button onclick="location.reload()">REBOOT SYSTEM</button>
        </div>
    </div>

    <audio id="snd-reveal" src="PASTE_YOUR_LINK_HERE"></audio>
    <audio id="snd-pass" src="PASTE_YOUR_LINK_HERE"></audio>

    <script>
        let players = [];
        let currentPlayerIndex = 0;
        let impostorName = "";
        let decks = JSON.parse(localStorage.getItem('impostee_decks')) || {};

        // Initialization
        window.onload = () => {
            const dropdown = document.getElementById('saved-decks-dropdown');
            for (let name in decks) {
                let opt = document.createElement('option');
                opt.value = name;
                opt.innerHTML = name;
                dropdown.appendChild(opt);
            }
        };

        function loadDeck() {
            const name = document.getElementById('saved-decks-dropdown').value;
            if (decks[name]) {
                document.getElementById('deck-name').value = name;
                document.getElementById('custom-words').value = decks[name];
            }
        }

        function startGame() {
            const name = document.getElementById('deck-name').value;
            const words = document.getElementById('custom-words').value;
            
            if (!name || !words) return alert("Enter deck details!");

            // Ask for player count with a slightly cooler prompt
            const countStr = prompt("ENTER ACTIVE UNITS (Player Count):", "3");
            const count = parseInt(countStr);
            if(isNaN(count) || count < 3) return alert("Need at least 3 units!");

            // Save deck to LocalStorage
            decks[name] = words;
            localStorage.setItem('impostee_decks', JSON.stringify(decks));

            const wordList = words.split(',').filter(w => w.trim().length > 0).map(w => w.trim());
            if(wordList.length < 2) return alert("Deck needs at least 2 words!");

            const secret = wordList[Math.floor(Math.random() * wordList.length)];
            const impIdx = Math.floor(Math.random() * count);
            impostorName = `UNIT ${impIdx + 1}`;

            players = Array.from({length: count}, (_, i) => 
                i === impIdx ? "IMPOSTOR" : secret
            );

            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            updateUI();
        }

        function updateUI() {
            if (currentPlayerIndex >= players.length) {
                document.getElementById('game-screen').classList.add('hidden');
                document.getElementById('reveal-screen').classList.remove('hidden');
                document.getElementById('impostor-reveal').innerText = impostorName;
                return;
            }
            document.getElementById('player-turn-text').innerText = `UNIT ${currentPlayerIndex + 1} READY`;
            document.getElementById('word-display').innerText = "****";
            document.getElementById('hold-trigger').classList.remove('hidden');
            document.getElementById('next-btn').classList.add('hidden');
        }

        // HOLD TO REVEAL LOGIC
        const trigger = document.getElementById('hold-trigger');
        const display = document.getElementById('word-display');
        const nextBtn = document.getElementById('next-btn');
        let isHolding = false;

        function showWord() {
            if(isHolding) return; // Prevent double trigger
            isHolding = true;
            display.innerText = players[currentPlayerIndex];
            display.style.color = players[currentPlayerIndex] === "IMPOSTOR" ? "var(--danger)" : "var(--glow)";
            // Only try to play if src is present to avoid errors in console
            const snd = document.getElementById('snd-reveal');
            if(snd.src) snd.play().catch(e => console.log("Sound trigger failed (check link)"));
        }

        function hideWord() {
            if(!isHolding) return;
            isHolding = false;
            display.innerText = "****";
            display.style.color = "var(--danger)";
            trigger.classList.add('hidden');
            nextBtn.classList.remove('hidden');
        }

        // Add both mouse and touch events for phone compatibility
        trigger.addEventListener('mousedown', showWord);
        trigger.addEventListener('touchstart', (e) => { e.preventDefault(); showWord(); }, {passive: false});
        trigger.addEventListener('mouseup', hideWord);
        trigger.addEventListener('touchend', hideWord);
        trigger.addEventListener('mouseleave', hideWord); // Handle dragging finger off button

        function nextPlayer() {
             // Only try to play if src is present
            const snd = document.getElementById('snd-pass');
            if(snd.src) snd.play().catch(e => console.log("Sound trigger failed (check link)"));
            currentPlayerIndex++;
            updateUI();
        }
    </script>
</body>
</html>
